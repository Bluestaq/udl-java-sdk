// File generated from our OpenAPI spec by Stainless.

package com.unifieddatalibrary.api.models.closelyspacedobjects.history

import com.fasterxml.jackson.module.kotlin.jacksonTypeRef
import com.unifieddatalibrary.api.core.jsonMapper
import java.time.OffsetDateTime
import kotlin.jvm.optionals.getOrNull
import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test

internal class HistoryListResponseTest {

    @Test
    fun create() {
        val historyListResponse =
            HistoryListResponse.builder()
                .classificationMarking("U")
                .csoState("POSSIBLE")
                .dataMode(HistoryListResponse.DataMode.TEST)
                .eventStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .eventType("RENDEZVOUS")
                .source("Bluestaq")
                .id("026dd511-8ba5-47d3-9909-836149f87686")
                .actorSvEpoch(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .analysisDuration(60.1)
                .analysisEpoch(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .compType("LONGITUDE")
                .contextKeys(listOf("MsnID_DescLabel", "msnVer", "serVer"))
                .contextValues(listOf("MissionID Descriptive Label text", "1", "001.9b"))
                .createdAt(OffsetDateTime.parse("2018-01-01T16:00:00.123Z"))
                .createdBy("some.user")
                .addCsoDetail(
                    HistoryListResponse.CsoDetail.builder()
                        .objectEvent("MEAN")
                        .objectType("DELTA")
                        .id("026dd511-8ba5-47d3-9909-836149f87686")
                        .apogee(1.1)
                        .classificationMarking("U")
                        .dataMode(HistoryListResponse.CsoDetail.DataMode.TEST)
                        .idCso("CSO-ID")
                        .inclination(45.1)
                        .longitude(45.1)
                        .perigee(1.1)
                        .build()
                )
                .deltaVTol(0.123)
                .durationThreshold(60.1)
                .eventEndTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .eventIntervalCoverage(22.3)
                .extId("EXTERNAL-ID")
                .hohmannDeltaV(0.012)
                .idActorSv("ACTOR-SV-ID")
                .idOnOrbit1("ONORBIT1-ID")
                .idOnOrbit2("ONORBIT2-ID")
                .idTargetSv("TARGET-SV-ID")
                .inclinationDeltaV(0.012)
                .indicationSource("Manually input")
                .lonTol(30.1)
                .maxRange(233.266)
                .minPlaneSepAngle(30.1)
                .minPlaneSepEpoch(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .minRange(0.5)
                .minRangeAnalysisDuration(60.1)
                .minRangeEpoch(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .notes("FREE-TEXT")
                .numSubIntervals(0)
                .orbitAlignDel(12.3)
                .orbitPlaneTol(1.23)
                .origin("THIRD_PARTY_DATASOURCE")
                .origNetwork("OPS1")
                .origObjectId1("ORIGONORBIT1-ID")
                .origObjectId2("ORIGONORBIT2-ID")
                .rangeThreshold(0.1)
                .rangeTol(0.123)
                .relPos(listOf(0.12, 0.23, -0.12))
                .relPosMag(0.12)
                .relSpeedMag(1.23)
                .relVel(listOf(0.12, 0.23, -0.12))
                .satNo1(1)
                .satNo2(2)
                .sourceDl("AXE")
                .stationLimLonTol(12.5)
                .targetSvEpoch(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .totalDeltaV(2.46)
                .build()

        assertThat(historyListResponse.classificationMarking()).isEqualTo("U")
        assertThat(historyListResponse.csoState()).isEqualTo("POSSIBLE")
        assertThat(historyListResponse.dataMode()).isEqualTo(HistoryListResponse.DataMode.TEST)
        assertThat(historyListResponse.eventStartTime())
            .isEqualTo(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(historyListResponse.eventType()).isEqualTo("RENDEZVOUS")
        assertThat(historyListResponse.source()).isEqualTo("Bluestaq")
        assertThat(historyListResponse.id()).contains("026dd511-8ba5-47d3-9909-836149f87686")
        assertThat(historyListResponse.actorSvEpoch())
            .contains(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(historyListResponse.analysisDuration()).contains(60.1)
        assertThat(historyListResponse.analysisEpoch())
            .contains(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(historyListResponse.compType()).contains("LONGITUDE")
        assertThat(historyListResponse.contextKeys().getOrNull())
            .containsExactly("MsnID_DescLabel", "msnVer", "serVer")
        assertThat(historyListResponse.contextValues().getOrNull())
            .containsExactly("MissionID Descriptive Label text", "1", "001.9b")
        assertThat(historyListResponse.createdAt())
            .contains(OffsetDateTime.parse("2018-01-01T16:00:00.123Z"))
        assertThat(historyListResponse.createdBy()).contains("some.user")
        assertThat(historyListResponse.csoDetails().getOrNull())
            .containsExactly(
                HistoryListResponse.CsoDetail.builder()
                    .objectEvent("MEAN")
                    .objectType("DELTA")
                    .id("026dd511-8ba5-47d3-9909-836149f87686")
                    .apogee(1.1)
                    .classificationMarking("U")
                    .dataMode(HistoryListResponse.CsoDetail.DataMode.TEST)
                    .idCso("CSO-ID")
                    .inclination(45.1)
                    .longitude(45.1)
                    .perigee(1.1)
                    .build()
            )
        assertThat(historyListResponse.deltaVTol()).contains(0.123)
        assertThat(historyListResponse.durationThreshold()).contains(60.1)
        assertThat(historyListResponse.eventEndTime())
            .contains(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(historyListResponse.eventIntervalCoverage()).contains(22.3)
        assertThat(historyListResponse.extId()).contains("EXTERNAL-ID")
        assertThat(historyListResponse.hohmannDeltaV()).contains(0.012)
        assertThat(historyListResponse.idActorSv()).contains("ACTOR-SV-ID")
        assertThat(historyListResponse.idOnOrbit1()).contains("ONORBIT1-ID")
        assertThat(historyListResponse.idOnOrbit2()).contains("ONORBIT2-ID")
        assertThat(historyListResponse.idTargetSv()).contains("TARGET-SV-ID")
        assertThat(historyListResponse.inclinationDeltaV()).contains(0.012)
        assertThat(historyListResponse.indicationSource()).contains("Manually input")
        assertThat(historyListResponse.lonTol()).contains(30.1)
        assertThat(historyListResponse.maxRange()).contains(233.266)
        assertThat(historyListResponse.minPlaneSepAngle()).contains(30.1)
        assertThat(historyListResponse.minPlaneSepEpoch())
            .contains(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(historyListResponse.minRange()).contains(0.5)
        assertThat(historyListResponse.minRangeAnalysisDuration()).contains(60.1)
        assertThat(historyListResponse.minRangeEpoch())
            .contains(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(historyListResponse.notes()).contains("FREE-TEXT")
        assertThat(historyListResponse.numSubIntervals()).contains(0)
        assertThat(historyListResponse.orbitAlignDel()).contains(12.3)
        assertThat(historyListResponse.orbitPlaneTol()).contains(1.23)
        assertThat(historyListResponse.origin()).contains("THIRD_PARTY_DATASOURCE")
        assertThat(historyListResponse.origNetwork()).contains("OPS1")
        assertThat(historyListResponse.origObjectId1()).contains("ORIGONORBIT1-ID")
        assertThat(historyListResponse.origObjectId2()).contains("ORIGONORBIT2-ID")
        assertThat(historyListResponse.rangeThreshold()).contains(0.1)
        assertThat(historyListResponse.rangeTol()).contains(0.123)
        assertThat(historyListResponse.relPos().getOrNull()).containsExactly(0.12, 0.23, -0.12)
        assertThat(historyListResponse.relPosMag()).contains(0.12)
        assertThat(historyListResponse.relSpeedMag()).contains(1.23)
        assertThat(historyListResponse.relVel().getOrNull()).containsExactly(0.12, 0.23, -0.12)
        assertThat(historyListResponse.satNo1()).contains(1)
        assertThat(historyListResponse.satNo2()).contains(2)
        assertThat(historyListResponse.sourceDl()).contains("AXE")
        assertThat(historyListResponse.stationLimLonTol()).contains(12.5)
        assertThat(historyListResponse.targetSvEpoch())
            .contains(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
        assertThat(historyListResponse.totalDeltaV()).contains(2.46)
    }

    @Test
    fun roundtrip() {
        val jsonMapper = jsonMapper()
        val historyListResponse =
            HistoryListResponse.builder()
                .classificationMarking("U")
                .csoState("POSSIBLE")
                .dataMode(HistoryListResponse.DataMode.TEST)
                .eventStartTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .eventType("RENDEZVOUS")
                .source("Bluestaq")
                .id("026dd511-8ba5-47d3-9909-836149f87686")
                .actorSvEpoch(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .analysisDuration(60.1)
                .analysisEpoch(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .compType("LONGITUDE")
                .contextKeys(listOf("MsnID_DescLabel", "msnVer", "serVer"))
                .contextValues(listOf("MissionID Descriptive Label text", "1", "001.9b"))
                .createdAt(OffsetDateTime.parse("2018-01-01T16:00:00.123Z"))
                .createdBy("some.user")
                .addCsoDetail(
                    HistoryListResponse.CsoDetail.builder()
                        .objectEvent("MEAN")
                        .objectType("DELTA")
                        .id("026dd511-8ba5-47d3-9909-836149f87686")
                        .apogee(1.1)
                        .classificationMarking("U")
                        .dataMode(HistoryListResponse.CsoDetail.DataMode.TEST)
                        .idCso("CSO-ID")
                        .inclination(45.1)
                        .longitude(45.1)
                        .perigee(1.1)
                        .build()
                )
                .deltaVTol(0.123)
                .durationThreshold(60.1)
                .eventEndTime(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .eventIntervalCoverage(22.3)
                .extId("EXTERNAL-ID")
                .hohmannDeltaV(0.012)
                .idActorSv("ACTOR-SV-ID")
                .idOnOrbit1("ONORBIT1-ID")
                .idOnOrbit2("ONORBIT2-ID")
                .idTargetSv("TARGET-SV-ID")
                .inclinationDeltaV(0.012)
                .indicationSource("Manually input")
                .lonTol(30.1)
                .maxRange(233.266)
                .minPlaneSepAngle(30.1)
                .minPlaneSepEpoch(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .minRange(0.5)
                .minRangeAnalysisDuration(60.1)
                .minRangeEpoch(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .notes("FREE-TEXT")
                .numSubIntervals(0)
                .orbitAlignDel(12.3)
                .orbitPlaneTol(1.23)
                .origin("THIRD_PARTY_DATASOURCE")
                .origNetwork("OPS1")
                .origObjectId1("ORIGONORBIT1-ID")
                .origObjectId2("ORIGONORBIT2-ID")
                .rangeThreshold(0.1)
                .rangeTol(0.123)
                .relPos(listOf(0.12, 0.23, -0.12))
                .relPosMag(0.12)
                .relSpeedMag(1.23)
                .relVel(listOf(0.12, 0.23, -0.12))
                .satNo1(1)
                .satNo2(2)
                .sourceDl("AXE")
                .stationLimLonTol(12.5)
                .targetSvEpoch(OffsetDateTime.parse("2019-12-27T18:11:19.117Z"))
                .totalDeltaV(2.46)
                .build()

        val roundtrippedHistoryListResponse =
            jsonMapper.readValue(
                jsonMapper.writeValueAsString(historyListResponse),
                jacksonTypeRef<HistoryListResponse>(),
            )

        assertThat(roundtrippedHistoryListResponse).isEqualTo(historyListResponse)
    }
}
